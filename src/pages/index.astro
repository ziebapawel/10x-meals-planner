---
import Layout from "../layouts/Layout.astro";
import LandingView from "../components/LandingView.astro";
import { HomeAndPlanGenerationView } from "../components/HomeAndPlanGenerationView";
import { Toaster } from "../components/ui/sonner";

// Get user from Astro.locals (set by middleware)
const user = Astro.locals.user;
---

<Layout title={user ? "Planer Posiłków - Generuj swój plan żywieniowy" : "Planer Posiłków - Inteligentne planowanie posiłków z AI"}>
  {user ? (
    <>
      {/* Authenticated users - show the meal plan generator */}
      <HomeAndPlanGenerationView client:load />
      <Toaster client:load />
    </>
  ) : (
    <>
      {/* Unauthenticated users - show the landing page */}
      <LandingView />
    </>
  )}
</Layout>
